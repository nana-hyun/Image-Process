# 5. Edge-based Segmentation Techniques

에지나 경계 : local pixel intensity gradient에 의해 정의된다.

기울기 = 영상함수의 1차 도함수의 근사치

f(x,y)가 주어질 때, 기울기의 크기를 계산하면 다음과 같다.

![image](https://user-images.githubusercontent.com/101063108/158070590-bf7823fb-ed49-42fe-8990-7fa75347c837.png)

기울기의 방향은 다음과 같다.

![image](https://user-images.githubusercontent.com/101063108/158070656-a8876cf3-0c30-4eea-975b-0960594c605b.png)

Gx = x방향으로의 기울기 Gy = y방향으로의 기울기

이산적 특성은 연속적 미분의 적용이 불가하므로, 기울기의 계산은 차이를 구하는 것으로 수행된다.

크기와 방향은 영상으로 보여질 수 있는데,

> 크기 ; local intensity 변화의 크기에 비례하는 gray level
>
> 방향 ; 원본 영상에서 최대 local 기울기의 방향을 나타내는 gray level

기울기 operator는 컨볼루션 계산들을 포함한다. ; local neighborhood에서 픽셀 명암의 가중합계

가중치 : local 영상 neighborhood ( mask, window or kernel)에 해당하는 형식의 숫자 배열로 나열 가능

3 x 3 Sobel edge operator : 3 x 3 mask 2개

![image](https://user-images.githubusercontent.com/101063108/158071507-67a2d43b-46ea-4c26-90ef-3f034d3fe044.png)

첫번째의 경우, Gx 계산에 사용되고, 두번째는 Gy 계산에 사용된다. 기울기 크기 영상은 Eq를 사용하여 Gx와 Gy를 결합함으로써 생성된다.


### Figure 7

![image](https://user-images.githubusercontent.com/101063108/158071785-de09dc14-c5ae-4443-b991-0e888db00ff6.png)

* 7A : Original 자기공명혈관 조영도 영상

* 7B : 7A에 3 x 3 obel operator 적용한 edge 자기 영상

에지 감지는 기울기 mask에 의해 결정되는데, 에지 감지 방법은 에지가 발견된 곳을 결정하기 위해 기울기 연산자를 사용한 다음 기울기에 대한 threshold연산을 사용하는 것이다.

결과 : 에지가 어디있는지 보여주는 binary image가 된다.

따라서 7C와 7D는 서로 다른 2개의 level에서의 thresholding 결과이다. 그러나 적절한 threshold를 찾는 것은 어렵다.

* 7C : 주요혈관 주위의 몇몇 배경이 포함된 에지

* 7D : 혈관을 완전히 둘러싸지 않은 에지



edge-based 기술은 계산적으로 빠름 & 영상 내용에 대한 사전정보가 요구되지 않는다는 장점이 있다.

하지만 문제점은 에지가 개체를 완전히 둘러싸지 않을 수 있다는 것인데, 지역을 둘러싸는 폐쇄된 경계를 형성하기 위해서 단일 경계에 해당하는 에지들을 연결하거나 그룹화하는 후처리 단계가 필요하다.

### edge linking

edge linking에 대한 가장 단순한 접근은 에지 픽셀의 작은 근처 픽셀을 검사하고 에지 크기 및 방향이 유사한 픽셀들을 연결하는 것을 포함한다.

일반적으로 edge linking은 계산적으로 비싸고 별로 믿을 수 없다.

한가지 해결책 : edge linking을 반자동으로 만들고 자동적인 기록이 모호해질 때, 사용자로 하여금 에지를 그리게 하는 것이다.

> hybrid algorithm : human operator가 오류 수정을 위해 해부학적 지식을 사용하여 edge를 기록하고 연산과 상호작용

### graph searching

애지 탐색을 위한 graph searching은 많은 의학적 응용에 사용된다.

영상 픽셀은 그래프 노드에 해당하며 그래프의 각 경로는 영상에서 가능한 에지에 해당한다.

각 노드 비용은 다음과 관련되어 있다.
> local 에지 크기, 에지 방향, 경계 모양 및 위치에 대한 사전지식을 사용해 계산되는 것

그래프를 통과하는 경로비용은 경로에 포함된 모든 노드의 하.

그래프에서 최적의 저비용 경로를 찾음으로써 최적 경계가 정해짐.

이 기술은 매우 강력하지만, application-specific 비용 함수에 크게 의존한다.

## Laplacian

1차 도함수의 peak들은 2차 도함수에서 0에 해당하기 때문에, 에지 검출에 Laplacian operator(2차 도함수 근사)가 사용 된다.

![image](https://user-images.githubusercontent.com/101063108/158072419-30af0cf7-cc0c-4ad1-9883-1ab6175ab8f7.png)

Laplacian은 N x N 컨볼루션 mask에 의해 근사되며, 영상 에지는 Laplacian이 0을 지나며 변화하는 픽셀의 위치를 찾음으로써(zero crossing) 발견될 수 있다.

### Figure 8

![image](https://user-images.githubusercontent.com/101063108/158072570-850a7493-614d-4583-b0d0-baa69754ff82.png)


* 8A : 7A에 3 x 3 Laplacian 적용 결과

* 8C : Laplacian의 zero crossing(부호 변환점)

기울기나 Laplacian을 기초로 하는 모든 에지 탐지 기법은 노이즈에 매우 민감하다.

몇몇 적용들에서 노이즈 효과는 에지 연산자 적용 전에 Smoothing에 의해 감소될 수 있으며, Smoothing에 Gaussian filter (Laplacian of Gaussian ; LoG)를 이용하기도 한다.

* 8B : 7 x 7 Gaussian과 Laplacian을 7A에 적용한 결과

* 8D : LoG의 zero crossing

LoG의 장점은 Laplacian에 비해 혈관 에지가 더 매끄럽고 윤곽이 잘 나타난다는것이다.

8C와 8D 둘다 거의 일정한 gray level 영역에서 중요하지 않은 에지를 탐지 했으며, 이를 해결하기 위해 1차 및 2차 도함수를 사용해 얻은 에지에 대한 정보를 결합했다.

LoG의 zero crossing과 기울기 크기 영상의 local 최대의 결합 후 curve-fitting algorithm을 적용한다.


# 6. Multispectral Techniques

전통적인 segmentation 기술은 CT나 MR 같은 한가지 데이터 타입을 나타내는 영상을 사용한다. 

여러 영상방식의로 얻어진 다른 영상들은 개체에 대한 다른 형상을 제공하고, 여러 이미지 정보의 통합 기반 분할을 multispectal / multimodal 이라고 한다.

## 6.1. Segmentation Using Multiple Images Aquired by Different Image Techniques

단일 이미지의 경우

* 단일 형상에 기반 (gray level)
* 1차원 형상 공간에서 분할 수행됨 (single channel)

다중스펙트럼 이미지의 경우 

* 각 픽셀들은 일련의 형상으로 특징지어짐.
* 다차원 형상 공간에서 clustering algorithm을 사용하여 분할 수행 ( multi-channel)




